---
name: node env
steps:
  - name: nodenv
    brew:
      brews:
        - nodenv
  - name: nodenv-update
    git:
      repo: nodenv/nodenv-update
      dest: $(/opt/homebrew/bin/nodenv root)/plugins/nodenv-update
  - name: ~/.node-version
    link:
      src: node/node-version
      dest: ${HOME}/.node-version
---
name: node
needs: node env
unless: nodenv shell $(cat "${HOME}/.node-version")
run: >
  VERSION=$(cat "${HOME}/.node-version")
  /opt/homebrew/bin/nodenv install ${VERSION}


#!/usr/bin/env bash

set -euo pipefail

get_ruby_version() {
  if [[ -f ".ruby-version" ]]; then
    cat .ruby-version
  else
    exit 1
  fi
}

# use first argument as ruby version, or try to guess
ruby_version="${1:-$(get_ruby_version)}"

echo "Installing Ruby version $ruby_version"
mise install ruby@"$ruby_version"

echo "Installing standard gems"
MISE_RUBY_VERSION="$ruby_version" \
  mise exec -- \
  gem install \
    bundler \
    standardrb \
    sorbet \
    ruby-lsp

